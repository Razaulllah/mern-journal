{"version":3,"file":"driver.js","mappings":"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","names":["STMDriver","constructor","self","journal","fiberId","r0","envStack","Stack","unwindStack","error","isRetry","result","undefined","contStack","cont","value","previous","_typeId","STM","STMOnFailureTypeId","onFailure","STMOnRetryTypeId","onRetry","run","curr","exit","k","STMSucceedTypeId","a","TExit","succeed","apply","STMSucceedNowTypeId","STMProvideSomeTypeId","f","ensuring_","stm","succeedWith","STMOnSuccessTypeId","STMEffectTypeId","e","isFailException","fail","isRetryException","retry","isDieException","die"],"sourceRoot":"","sources":["../../../_src/Transactional/STM/_internal/driver.ts"],"sourcesContent":[null]}